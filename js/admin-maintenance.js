(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{ZrHZ:function(e,a,t){"use strict";t.r(a);var n=t("o0o1"),r=t.n(n),o=t("vDqi"),s=t.n(o),c=t("4HBT"),i=t.n(c),m=t("C3Ci"),d=t("ZXch");function l(e,a,t,n,r,o,s){try{var c=e[o](s),i=c.value}catch(e){return void t(e)}c.done?a(i):Promise.resolve(i).then(n,r)}function u(e){return function(){var a=this,t=arguments;return new Promise((function(n,r){var o=e.apply(a,t);function s(e){l(o,n,r,s,c,"next",e)}function c(e){l(o,n,r,s,c,"throw",e)}s(void 0)}))}}var v={middleware:["auth","verified","2fa_passed","admin"],metaInfo:function(){return{title:this.$t("Maintenance")}},mixins:[m.a],computed:{commands:function(){return this.data.commands?this.data.commands.map((function(e){return{value:e.class,text:e.description}})):[]}},data:function(){return{data:{},maintenanceFormIsValid:null,maintenanceForm:new i.a({message:this.$t("Sorry, we are doing some maintenance. Please check back soon.")}),commandFormIsValid:null,commandForm:new i.a({command:null,arguments:{}}),migrationForm:new i.a,cacheForm:new i.a,cronForm:new i.a}},created:function(){var e=this;return u(r.a.mark((function a(){var t,n;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.a.get("/api/admin/maintenance");case 2:t=a.sent,n=t.data,e.data=n;case 5:case"end":return a.stop()}}),a)})))()},methods:{switchMaintenanceMode:function(){var e=this;return u(r.a.mark((function a(){var t,n,o;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.data.maintenance_mode?"up":"down",a.next=3,e.maintenanceForm.post("/api/admin/maintenance/".concat(t));case 3:n=a.sent,o=n.data,e.data.maintenance_mode=!e.data.maintenance_mode,e.$store.dispatch("message/success",{text:o.message});case 7:case"end":return a.stop()}}),a)})))()},executeCommand:function(){var e=this;return u(r.a.mark((function a(){var t,n;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.commandForm.post("/api/admin/maintenance/command");case 2:t=a.sent,n=t.data,e.$store.dispatch("message/success",{text:n.message});case 5:case"end":return a.stop()}}),a)})))()},migrate:function(){var e=this;return u(r.a.mark((function a(){var t,n;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.migrationForm.post("/api/admin/maintenance/migrate");case 2:t=a.sent,n=t.data,e.$store.dispatch("message/success",{text:n.message});case 5:case"end":return a.stop()}}),a)})))()},clearCache:function(){var e=this;return u(r.a.mark((function a(){var t,n;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.cacheForm.post("/api/admin/maintenance/cache");case 2:t=a.sent,n=t.data,e.$store.dispatch("message/success",{text:n.message});case 5:case"end":return a.stop()}}),a)})))()},cron:function(){var e=this;return u(r.a.mark((function a(){var t,n;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.cronForm.post("/api/admin/maintenance/cron");case 2:t=a.sent,n=t.data,e.$store.dispatch("message/success",{text:n.message});case 5:case"end":return a.stop()}}),a)})))()},copyToClipboard:function(e){return Object(d.b)(e.$el.querySelector("input"))}}},p=t("KHd+"),f=t("ZUTo"),_=t.n(f),h=t("gzZi"),b=t("sK+t"),g=t("mdmw"),w=t("Yq0q"),F=t("pSOK"),x=t("S9TP"),y=t("D9m0"),$=t("uXRr"),k=t("MSko"),C=t("hlRy"),V=Object(p.a)(v,(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-container",[t("v-row",[t("v-col",{attrs:{cols:"12"}},[t("v-card",[t("v-card-title",[e._v("\n          "+e._s(e.$t("Maintenance"))+"\n        ")]),e._v(" "),t("v-card-text",[t("v-row",[t("v-col",[t("v-card",{attrs:{outlined:""}},[t("v-card-title",{staticClass:"font-weight-thin"},[e._v("\n                  "+e._s(e.$t("System info"))+"\n                ")]),e._v(" "),t("v-card-text",[t("v-skeleton-loader",{attrs:{type:"text",loading:!e.data.system_info}},[e._v("\n                    "+e._s(e.data.system_info)+"\n                  ")])],1)],1)],1)],1),e._v(" "),t("v-row",[t("v-col",[t("v-card",{attrs:{outlined:""}},[t("v-card-title",{staticClass:"font-weight-thin"},[e._v("\n                  "+e._s(e.$t("Maintenance mode"))+"\n                ")]),e._v(" "),t("v-card-text",[t("p",[e._v("\n                  "+e._s(e.$t("You can enable maintenance mode during application upgrade or when doing other service tasks, so nobody except administrators can use the website."))+"\n                  ")]),e._v(" "),t("v-form",{staticClass:"mt-5",on:{submit:function(a){return a.preventDefault(),e.switchMaintenanceMode(a)}},model:{value:e.maintenanceFormIsValid,callback:function(a){e.maintenanceFormIsValid=a},expression:"maintenanceFormIsValid"}},[t("v-text-field",{attrs:{label:e.$t("Message"),rules:[e.validationRequired],error:e.maintenanceForm.errors.has("message"),"error-messages":e.maintenanceForm.errors.get("message"),disabled:void 0===e.data.maintenance_mode||e.data.maintenance_mode,outlined:""},model:{value:e.maintenanceForm.message,callback:function(a){e.$set(e.maintenanceForm,"message",a)},expression:"maintenanceForm.message"}}),e._v(" "),t("v-skeleton-loader",{attrs:{type:"button",loading:void 0===e.data.maintenance_mode}},[t("v-btn",{attrs:{type:"submit",color:"primary",disabled:!e.maintenanceFormIsValid||e.maintenanceForm.busy,loading:e.maintenanceForm.busy}},[e.data.maintenance_mode?[e._v("\n                          "+e._s(e.$t("Disable maintenance mode"))+"\n                        ")]:[e._v("\n                          "+e._s(e.$t("Enable maintenance mode"))+"\n                        ")]],2)],1)],1)],1)],1)],1)],1),e._v(" "),t("v-row",[t("v-col",[t("v-card",{attrs:{outlined:""}},[t("v-card-title",{staticClass:"font-weight-thin"},[e._v("\n                  "+e._s(e.$t("Tasks"))+"\n                ")]),e._v(" "),t("v-card-text",[t("p",[e._v("\n                    "+e._s(e.$t("The app provides a number of service tasks, which can be executed on demand."))+"\n                  ")]),e._v(" "),t("v-form",{staticClass:"mt-5",on:{submit:function(a){return a.preventDefault(),e.executeCommand(a)}},model:{value:e.commandFormIsValid,callback:function(a){e.commandFormIsValid=a},expression:"commandFormIsValid"}},[t("v-select",{attrs:{items:e.commands,label:e.$t("Task"),error:e.commandForm.errors.has("command"),"error-messages":e.commandForm.errors.get("command"),outlined:"",disabled:!e.data.commands},model:{value:e.commandForm.command,callback:function(a){e.$set(e.commandForm,"command",a)},expression:"commandForm.command"}}),e._v(" "),e.commandForm.command?[e._l(e.data.commands,(function(a){return[a.class===e.commandForm.command?e._l(a.arguments,(function(a,n){return t("v-text-field",{key:n,attrs:{label:e.$t(a.title),rules:[e.validationRequired],placeholder:a.default,error:e.commandForm.errors.has("arguments"),"error-messages":e.commandForm.errors.get("arguments"),outlined:""},model:{value:e.commandForm.arguments[a.id],callback:function(t){e.$set(e.commandForm.arguments,a.id,t)},expression:"commandForm.arguments[arg.id]"}})})):e._e()]}))]:e._e(),e._v(" "),t("v-skeleton-loader",{attrs:{type:"button",loading:void 0===e.data.commands}},[t("v-btn",{attrs:{type:"submit",color:"primary",disabled:!e.commandForm.command||!e.commandFormIsValid||e.commandForm.busy,loading:e.commandForm.busy}},[e._v("\n                        "+e._s(e.$t("Execute"))+"\n                      ")])],1)],2)],1)],1)],1)],1),e._v(" "),t("v-row",[t("v-col",[t("v-card",{attrs:{outlined:""}},[t("v-card-title",{staticClass:"font-weight-thin"},[e._v("\n                  "+e._s(e.$t("Database"))+"\n                ")]),e._v(" "),t("v-card-text",[t("p",[e._v("\n                    "+e._s(e.$t("After upgrading to a new version of the application it is necessary to update the database objects."))+"\n                    "+e._s(e.$t("All current data will be preserved."))+"\n                  ")]),e._v(" "),t("v-form",{on:{submit:function(a){return a.preventDefault(),e.migrate(a)}}},[t("v-btn",{attrs:{type:"submit",color:"primary",disabled:e.migrationForm.busy,loading:e.migrationForm.busy}},[e._v("\n                      "+e._s(e.$t("Update database"))+"\n                    ")])],1)],1)],1)],1)],1),e._v(" "),t("v-row",[t("v-col",[t("v-card",{attrs:{outlined:""}},[t("v-card-title",{staticClass:"font-weight-thin"},[e._v("\n                  "+e._s(e.$t("Cache"))+"\n                ")]),e._v(" "),t("v-card-text",[t("p",[e._v("\n                  "+e._s(e.$t("The application caches templates, configuration, translation strings, aggregated data etc to improve performance."))+"\n                  "+e._s(e.$t("To clear all caches at once click the button below."))+"\n                  ")]),e._v(" "),t("v-form",{on:{submit:function(a){return a.preventDefault(),e.clearCache(a)}}},[t("v-btn",{attrs:{type:"submit",color:"primary",disabled:e.cacheForm.busy,loading:e.cacheForm.busy}},[e._v("\n                      "+e._s(e.$t("Clear cache"))+"\n                    ")])],1)],1)],1)],1)],1),e._v(" "),t("v-row",[t("v-col",[t("v-card",{attrs:{outlined:""}},[t("v-card-title",{staticClass:"font-weight-thin"},[e._v("\n                  "+e._s(e.$t("Cron"))+"\n                ")]),e._v(" "),t("v-card-text",[t("p",[e._v("\n                    "+e._s(e.$t("Certain application tasks are supposed to run automatically on a regular basis."))+"\n                    "+e._s(e.$t("To make it work please add the following system cron job."))+"\n                    "+e._s(e.$t("Please note that the command-line (cli) PHP version on your server should also meet the minimum PHP version requirements, otherwise the cron job will fail to execute."))+"\n                    "+e._s(e.$t("If you add the cron job via cPanel you need to omit the leading asteriks symbols."))+"\n                  ")]),e._v(" "),t("v-form",{on:{submit:function(a){return a.preventDefault(),e.cron(a)}}},[t("v-text-field",{ref:"cron",attrs:{dense:"",outlined:"",readonly:"","append-icon":"mdi-content-copy",value:e.data.cron_job,disabled:!e.data.cron_job},on:{"click:append":function(a){return e.copyToClipboard(e.$refs.cron)}}}),e._v(" "),t("v-btn",{attrs:{type:"submit",color:"primary",disabled:e.cronForm.busy,loading:e.cronForm.busy}},[e._v("\n                      "+e._s(e.$t("Execute cron job manually"))+"\n                    ")])],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null);a.default=V.exports;_()(V,{VBtn:h.a,VCard:b.a,VCardText:g.c,VCardTitle:g.d,VCol:w.a,VContainer:F.a,VForm:x.a,VRow:y.a,VSelect:$.a,VSkeletonLoader:k.a,VTextField:C.a})}}]);
//# sourceMappingURL=admin-maintenance.js.map