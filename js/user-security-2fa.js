(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{Uuwf:function(e,t,r){"use strict";r.r(t);var o=r("o0o1"),n=r.n(o),a=r("4HBT"),i=r.n(a),s=r("C3Ci"),c=r("L2JU");function l(e,t,r,o,n,a,i){try{var s=e[a](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(o,n)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(o,n){var a=e.apply(t,r);function i(e){l(a,o,n,i,s,"next",e)}function s(e){l(a,o,n,i,s,"throw",e)}i(void 0)}))}}function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var p={mixins:[s.a],metaInfo:function(){return{title:this.$t("Two-factor authentication")}},data:function(){return{showPassword:!1,disablingFormIsValid:null,confirmationFormIsValid:null,enablingForm:new i.a,disablingForm:new i.a,confirmationForm:new i.a({secret:"",one_time_password:""}),qr:null,displayDisablingForm:!1}},computed:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},Object(c.d)("auth",["user"])),methods:{enable:function(){var e=this;return u(n.a.mark((function t(){var r,o;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.enablingForm.post("/api/user/security/2fa/enable");case 2:r=t.sent,o=r.data,e.qr=o.qr,e.confirmationForm.secret=o.secret;case 6:case"end":return t.stop()}}),t)})))()},confirm:function(){var e=this;return u(n.a.mark((function t(){var r,o;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.confirmationForm.post("/api/user/security/2fa/confirm");case 2:r=t.sent,o=r.data,e.$store.dispatch("auth/updateUser",o),e.qr=null,e.$store.dispatch("message/success",{text:e.$t("Two-factor authentication successfully enabled.")});case 7:case"end":return t.stop()}}),t)})))()},disable:function(){var e=this;return u(n.a.mark((function t(){var r,o;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.disablingForm.post("/api/user/security/2fa/disable");case 2:r=t.sent,o=r.data,e.$store.dispatch("auth/updateUser",o),e.$store.dispatch("message/success",{text:e.$t("Two-factor authentication successfully disabled.")});case 6:case"end":return t.stop()}}),t)})))()}}},f=r("KHd+"),b=r("ZUTo"),w=r.n(b),v=r("gzZi"),_=r("sK+t"),h=r("mdmw"),g=r("Yq0q"),y=r("pSOK"),F=r("S9TP"),x=r("D9m0"),$=r("hlRy"),O=r("cdmR"),P=r("Kn9U"),V=Object(f.a)(p,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[r("v-row",{attrs:{justify:"center"}},[r("v-col",{attrs:{cols:"12",sm:"8",md:"6",lg:"4"}},[r("v-card",[r("v-toolbar",[r("v-toolbar-title",[e._v("\n            "+e._s(e.$t("Two-factor authentication"))+"\n          ")])],1),e._v(" "),e.user.two_factor_auth_enabled&&e.user.two_factor_auth_passed?[e.displayDisablingForm?[r("v-card-text",[r("p",[e._v("\n                "+e._s(e.$t("Please fill in the below form to disable two-factor authentication."))+"\n              ")]),e._v(" "),r("v-form",{on:{submit:function(t){return t.preventDefault(),e.disable(t)}},model:{value:e.disablingFormIsValid,callback:function(t){e.disablingFormIsValid=t},expression:"disablingFormIsValid"}},[0==e.user.profiles.length?r("v-text-field",{attrs:{label:e.$t("Current password"),"append-icon":e.showPassword?"mdi-eye":"mdi-eye-off",type:e.showPassword?"text":"password",name:"password",rules:[e.validationRequired],error:e.disablingForm.errors.has("password"),"error-messages":e.disablingForm.errors.get("password"),outlined:"",counter:""},on:{"click:append":function(t){e.showPassword=!e.showPassword},keydown:function(t){return e.clearFormErrors(t,"password",e.disablingForm)}},model:{value:e.disablingForm.password,callback:function(t){e.$set(e.disablingForm,"password",t)},expression:"disablingForm.password"}}):e._e(),e._v(" "),r("v-text-field",{attrs:{label:e.$t("One-time password"),type:"text",name:"one_time_password",rules:[e.validationRequired,function(t){return e.validationMinLength(t,6)}],error:e.disablingForm.errors.has("one_time_password"),"error-messages":e.disablingForm.errors.get("one_time_password"),outlined:""},on:{keydown:function(t){return e.clearFormErrors(t,"one_time_password",e.disablingForm)}},model:{value:e.disablingForm.one_time_password,callback:function(t){e.$set(e.disablingForm,"one_time_password",t)},expression:"disablingForm.one_time_password"}}),e._v(" "),r("v-btn",{attrs:{type:"submit",color:"primary",disabled:!e.disablingFormIsValid||e.disablingForm.busy,loading:e.disablingForm.busy}},[e._v("\n                  "+e._s(e.$t("Confirm"))+"\n                ")])],1)],1)]:[r("v-card-text",[r("p",[e._v("\n                "+e._s(e.$t("Two-factor authentication is currently enabled."))+"\n              ")]),e._v(" "),r("v-btn",{attrs:{color:"primary"},on:{click:function(t){e.displayDisablingForm=!e.displayDisablingForm}}},[e._v(e._s(e.$t("Disable")))])],1)]]:[e.qr?[r("v-card-text",[r("p",[e._v(e._s(e.$t("Please do the following to enable two-factor authentication.")))]),e._v(" "),r("ul",[r("li",[e._v(e._s(e.$t("Open Google Authenticator app on your mobile phone.")))]),e._v(" "),r("li",[e._v(e._s(e.$t("Scan the below QR code with the authenticator app.")))]),e._v(" "),r("li",[e._v(e._s(e.$t("After that input the one-time password that you see on the screen to complete the process.")))])]),e._v(" "),r("div",{staticClass:"my-5 text-center",domProps:{innerHTML:e._s(e.qr)}}),e._v(" "),r("v-form",{on:{submit:function(t){return t.preventDefault(),e.confirm(t)}},model:{value:e.confirmationFormIsValid,callback:function(t){e.confirmationFormIsValid=t},expression:"confirmationFormIsValid"}},[r("v-text-field",{attrs:{label:e.$t("One-time password"),type:"text",name:"one_time_password",rules:[e.validationRequired,function(t){return e.validationMinLength(t,6)}],error:e.confirmationForm.errors.has("one_time_password"),"error-messages":e.confirmationForm.errors.get("one_time_password"),outlined:""},on:{keydown:function(t){return e.clearFormErrors(t,"one_time_password",e.confirmationForm)}},model:{value:e.confirmationForm.one_time_password,callback:function(t){e.$set(e.confirmationForm,"one_time_password",t)},expression:"confirmationForm.one_time_password"}}),e._v(" "),r("v-btn",{attrs:{type:"submit",color:"primary",disabled:!e.confirmationFormIsValid||e.confirmationForm.busy,loading:e.confirmationForm.busy}},[e._v("\n                  "+e._s(e.$t("Confirm"))+"\n                ")])],1)],1)]:[r("v-card-text",[r("p",[e._v("\n              "+e._s(e.$t("2-step verification provides stronger security for your account by requiring a second step of verification when you sign in."))+"\n              "+e._s(e.$t("In addition to your password, you will also need a code generated by the Google Authenticator app on your phone."))+"\n              "+e._s(e.$t("It is strongly recommended to enable two-factor authentication to protect your account."))+"\n              ")]),e._v(" "),r("v-btn",{attrs:{color:"primary",disabled:e.enablingForm.busy,loading:e.enablingForm.busy},on:{click:e.enable}},[e._v(e._s(e.$t("Enable")))])],1)]]],2)],1)],1)],1)}),[],!1,null,null,null);t.default=V.exports;w()(V,{VBtn:v.a,VCard:_.a,VCardText:h.c,VCol:g.a,VContainer:y.a,VForm:F.a,VRow:x.a,VTextField:$.a,VToolbar:O.a,VToolbarTitle:P.a})}}]);
//# sourceMappingURL=user-security-2fa.js.map